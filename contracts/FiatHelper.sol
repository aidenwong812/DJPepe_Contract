/**

www.WrappedPlatform.com
                                 ,;¿╓╖╖www╖╓;,
                        -,╓g@╨╜▒░░rⁿ*"""ⁿⁿ**≡░░▒╜MHw┌
                   .─*╖M╜░='"`                    ''^░╙ª╖,
                .*'┌╜░─'           ,▄▄▄▄▄▄▄▄▄▄▄,        `~╙*,
              .░`,           ¿▄@▓█▓▓▓▓▓▓▓▓▓▓███████▄▄,       "".
           ,g╢▓██▌-       ▄▓█▒▓╢▒▓▓▓▓▓▓▓▓▓▓▓▓▓█████████▌ç       ,▄
         ╒╣╣╣▓███▀    .g▓▓▓▒▒▒╣╣╢╢▓▓▓▓▓▓▓▓██▀`      `▀▀███Ç.,.  .╙███.
         ╣Ñ╝"▀██▀   ,║▒▒▒╫░▒▒▒▒▒╢▒╣╢▓▓▓▓▓█▒╖╓..;╖@@▓▓▄p.╙██▄ ░░░░░╜███ç
        '.,¡█▌'`   ║▒░░░"▒░▒▒▒▒▒▒▒╣╢╣▓▓▓╢████▓▒░▒▓██████▄.▀█▄ └░░░└░█▀▀
        â╣▒█▌    .░░└"'` h░░░▒▒▒▒▒╫▒╫╣▓╬▓██████████████████▓█r `*",:╨█.
       ┌╢╢▐█▒╠╫▓▌▌░!=`   µ¡░░░▒▒▒▒▒▒╫╫╣╬▒▓████████████████████µ,─¡└└░▒█.
      .╢▀╫∩█▌▒╢▒███'¿╓,  L"└░░▒▒▒▒▒▒╜╙╙╙└",,,,     ..,╓╖╥╖¡,"╙▀   '¡¡└╢█╓
     ░@▒▒¿└²█▌╙╢▒█▒▌░╢╣r ╘`'"'`   .╓p@▓▓▓▓▓▓@▄;    '╓@╣▓▓▓▓▓▓▓▄,   '▒▒░╨██╖
    ╥╣▒▒▒▒░ ██µ╠▒█▌█└╫▓▒       ,░░▒▒▒╢╢▒▒▒▀▀▀▀▀Ñµ¿░▒▒▒╢╣▓▓╣╣╢╜╜░░'  '▓╣░╙███▄.
   ╔▒╣║▒▒▒░`▐█▌:▒▒██─╣╣▒,   `,¡░░░░░░└`.'"└░░░=. └▒░░░░▄@▀" "└""└":   ║▒~╢████⌐
  \▒╣▓▓▓║▒░⌐▐█▌'▒▒██═░▒░`  `''^─«╘≡═           ``  ▒░▄▓▓∩              ::╘▐█▓█▒
  ║▒╫▒@▓▒▒░`▐█▌'▒╫▌█`└░"       ,╓╗║~               ██▓▓▒L                 ▒█▌█▌
 '▒▒╫▒▄▒▒▒░ ▓█r¡░▓▌█ '``      "╙╝▒▒═               ▓╜╢▒▒░                 Ñ█▌▓█
 ¡▒▒▒▒▒╣╣░`]▓▌,░░▓▐▌     `        ~"          ``  /░m¿.    '........,     ▒█▌▓▌
 └╢▒▒▒▒╣░r,╫▓¡░░╣▒▓      ```      `.```~,,...',⌐ .░░░░░¡.   ,─;;;≈┘"     j▐█▒▓^
  ░╣▒╣▒▒"╓╫Ñ░░░▒╣║`      ````       ```''─"""┐╓▒▓██▄▄▄└"'`    `░┐        ñ▓▓╢Ñ
   ╙▒░░╓║╫░░░░▒▒╠┘       ````              .╓▒╫▓▓▓███████▌@p╖╓╓░▒ç      /╟▓╢╩
    n░╜▓╣▒▒▒▒▒▒╟`        ````........,,;╓░▒▒╢╢▓▓▓▓▓▓█████▓▓▓╣╣╢╢╢╫   `'¡╢╣╜`
  H▒└`'└▓▓╣▒▒@╙          `..',╓╖╖╖µ|░░░░▒▒▒▒▒▒▒╢╢╣╢▓▓▓▓▓▓▓▓╣╣╣▒╣╣╫▓r.╓╨╙`
  ╙'''''''└┘ ,,.        `.:`.░░░░░░░░▒▒ÑÑ╬@▄▄▄▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓▓▓▌└
            .▓▒░░~'``````'" '░░MH∩╖┌,,'"²░░░░░░▒▒▒▒▒▀▀▀▀▒▒▒▒▒▒▒╨▒▒
              ╢▒░¡~~'`.````` `"^=»░░░░░░░╜MHHm╥╥▄▄▄▄▄▄▄▄▄▄▄@@@╬╣▒╜
               ╨▒░¡┌~~,,''``````````  .`'"^└░░░░░░░░░░░░░░░░░░╙"
                `╨░░¡~~~~~,,,,,,,,,,,,,,,,,,,,..........,,¡¿"
                ∩░.'"░~~~~~~~~~~~~~~~~~~~:┌┌┌┌┌┌┌┌┌¡¡¡░░┴"
             ╓░┘` '-,    `'''::~~~~~""""""┌¡¡¡░░░░▒▒▓▓▄,
           .░└````...."─=,.           ```        ▒▒▓▓████╖
        .H░┌ ░░¡¡¡¡¡┌┌┌┌¡:¡└└«. .,,,....,,:¿░░░ ~▒╫▓▓██████▌ç
      ┌║░░░░┐]▒▒▒▒▒▒▒░░░░░░░¡¡¡' ┌░░░░░░░░░░░▒▒`▐▓▓▓██████████
    ╓╣▒▒╢╢╢╢▓`▓▓▓▓╣╣▒▒▒▒▒▒▒▒░░░░,`░░░░░░░▒▒▒▒╢╣.▓▓▓██▓▓▓██████▌

  _____       _   _____                  _   _ ______ _______   __  __            _        _         _                
 |  __ \     | | |  __ \                | \ | |  ____|__   __| |  \/  |          | |      | |       | |               
 | |  | |    | | | |__) |__ _ __   ___  |  \| | |__     | |    | \  / | __ _ _ __| | _____| |_ _ __ | | __ _  ___ ___ 
 | |  | |_   | | |  ___/ _ \ '_ \ / _ \ | . ` |  __|    | |    | |\/| |/ _` | '__| |/ / _ \ __| '_ \| |/ _` |/ __/ _ \
 | |__| | |__| | | |  |  __/ |_) |  __/ | |\  | |       | |    | |  | | (_| | |  |   <  __/ |_| |_) | | (_| | (_|  __/
 |_____/ \____/  |_|   \___| .__/ \___| |_| \_|_|       |_|    |_|  |_|\__,_|_|  |_|\_\___|\__| .__/|_|\__,_|\___\___|
                           | |                                                                | |                     
                           |_|                                                                |_|                     
 */
// SPDX-License-Identifier: MIT

pragma solidity ^0.8.0;

import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

import "./interfaces/INFTAuction.sol";

contract FiatHelper is Ownable {
    address public constant NATIVE_ADDRESS =
        address(0x00eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee);

    address public nftAuctioner;

    event FiatBidSuccess(
        address _from,
        INFTAuction.Auction auction,
        uint256 price,
        uint256 _bidIndex
    );

    receive() external payable {}

    constructor(address owner) {
        _transferOwnership(owner);
    }

    function setNftAuctioner(address auctioner) external onlyOwner {
        nftAuctioner = auctioner;
    }

    function bidOnAuction(
        uint256 _auctionId,
        uint256 amount,
        address fromAddress
    ) external onlyOwner {
        require(nftAuctioner != address(0), "Not configured fiat helper");
        INFTAuction.Auction memory auction = INFTAuction(nftAuctioner).auctions(
            _auctionId
        );
        address tokenAddress = auction.tokenAddr;
        if (tokenAddress == NATIVE_ADDRESS) {
            INFTAuction(nftAuctioner).bidOnAuction{value: amount}(
                _auctionId,
                amount,
                fromAddress
            );
        } else {
            IERC20(tokenAddress).approve(nftAuctioner, amount);
            INFTAuction(nftAuctioner).bidOnAuction{value: 0x0}(
                _auctionId,
                amount,
                fromAddress
            );
        }
        emit FiatBidSuccess(fromAddress, auction, amount, 0);
    }

    function emergencyWithdrawToken(
        address token_,
        address to_,
        uint256 amount_
    ) public onlyOwner {
        SafeERC20.safeTransfer(IERC20(token_), to_, amount_);
    }

    function emergencyWithdrawCoin(
        address payable to_,
        uint256 amount_
    ) public onlyOwner {
        (bool result, ) = to_.call{value: amount_}("");
        require(result, "withdraw failed");
    }
}
